/*
 * Copyright (c) 2021-2022. Jan Sohn.
 * All rights reserved.
 * I don't want anyone to use my source code without permission.
 */
const {Image} = require('image-js');
const fs = require('fs');
const xxAROX_Christmas = "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";
const xxAROX = "iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADxklEQVR4nO2bMU8bMRTH/7kLaYKiTkCYGaOQjYqOqcRYRjohVUURlZDKwOdgoEPVqqjqmrXdCiofoFuEGJlJqNShEYWk53Q4bHyOz/bl7noh+DfFZz/fe+/u7Gf7JQcNZP/tkC9/3n0dqH958B6q+lf5Qk53jyzJmzQiu+sAAOfkHFVy548z59a2eo1dk9ZPMI5xw5PzNPXIDCMHTKvxgMEn0NsuwXV7rNz1Tthvr3+prZ90jD8BkfpMTd/oHjCWA6bFeMBwFvC8DvvdQRFH3Gsuq79P5MR5vrddUgq0HMFAEiy6xRdKeTFucPbeZDpX+m8AN4+7bg+PZuoAgKvrIwBAqbQGAOj326igwNp2PH+QWys2AADtwSkWJHHAM3QBABdkPnAvtE8TNWYcpGPAzaA9cq3fH73G0x6ojbkg8xHU+n+EDoK8E6bVeMBgFnhcbobWNcubiSqTBXkAII2l0GhvdXUVADD74yMA4Pnt9a8rO6xOxqJziTMshNaTxhKcSRoDSGNJ2uDb8RYA4GqlCRwCOPSNB4Ct4x2pzKKjjgDD7pUFeQBwDr6wC97T0WmQzvO/362jhSLgBQ3scOWfM7mRJ8+vCp+0TyfiyVPy4jxMEIwLRJp7TeW8TfZ/KfcPRD797Qfa6/YPxLhFJGpcIY8E6VxNn5RY1qHbH4i7fxBXP44RB/CrO/o5BMp76g7TXj3G1U9E+gbwsb2srEO3Noi7doirHw9bC+jWAOUPf5T1YfKtEAPD1gziWkHXPyVMP92Y4McBu+uYxV3sP1v0Y39adt0KUC+zb4ztEdLZo16D6/bYk6DyNwP52qHizmOBDNk3z48DqNfYNEn7j62fAhYH8KGvbC0QEDLYItP1EbX/KPqF9SFtZ3LDqDeIY7ys/6j6RdnDHHtLbFqwDshagayxDshagaxhDqD7gOJvGeMsZ1Vb6brls6iTTj/AXEcnrHGSTjA5R1A5Iap+UXR78KGwxWKxWCwWi8VisVgslodH4psF4nm/d90K1DfLm8p7ivIiSf//IJVN0SoZBs77lgsbWC5sjC0/N/iOucH3RHWkGKXKRsG7bqHr+mlx9Ly/K6TWRpUHLQtvUxIk7gAgmDMkK6ctH4XY3xP9ZnVPR5dDPK583DEhkTGgSoaouHfZoGvFBssfpmWaLwz4ucN8uUqGgTEiqnwcUjsZ4tNnZam0YvqsOE6o5JNMvU3FATqDdQbI5NNygj0bzFqBrLEOyFqBrLEOSKtj/khcdjyuywlQyZvkE5iSigN0BkcxPuxaUk548KHwP7sI1YjPkFI0AAAAAElFTkSuQmCC";
/**
 * @param {string} base64SkinData
 * @return {Promise<Image>}
 */
module.exports.decodeSkinData = async function (base64SkinData) {
	if (!base64SkinData) {
		throw new Error("base64SkinData must be a encoded png file")
	}
	await fs.promises.writeFile(".temp", Buffer.from(base64SkinData, "base64"));
	let image = Image.load(".temp");
	if (fs.existsSync(".temp")) {
		fs.rmSync(".temp");
	}
	return image;
};

/**
 * @param {Image} image
 * @return {Promise<string>}
 */
module.exports.encodeSkinData = async function (image) {
	return image.toBase64("image/png").toString();
};

